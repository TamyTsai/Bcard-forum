<!-- 單一文章頁面 -->
<div class="bgc-dark-blue min-h-screen">
    <section class="columns max-w-3xl mx-auto">
        <section class="column is-12 bg-neutral-100 my-4 rounded p-14">
            <div class="text-3xl font-bold mb-4"><%= @post.title %></div>
            <!-- <div class="text-3xl font-bold"><= link_to post.title, post_page_path(post.user.username, post) %></div> -->
            <section class="columns">
                <section class="column is-10">
                    <article class="media">
                        <figure class="media-left mr-2">
                            <!-- <img src="https://fakeimg.pl/25x25/" class="avatar"> -->
                            <!-- 有上傳頭貼 顯示上傳的頭貼，沒頭貼 顯示灰頭 -->
                            <% if @post.user.avatar.attached? %>
                                <%= image_tag @post.user.avatar.variant(resize_to_fill: [25, 25]), class: 'avatar' %>
                            <% else %>
                                <i class="fa-solid fa-circle-user text-gray-500 text-2xl"></i>
                            <% end %>
                        </figure>
                        <div class="media-content">
                            <!-- ID -->
                            <span class="text-gray-500">@<%= link_to @post.user.username, user_page_path(@post.user.username) %></span>
                            <!-- <span class="text-gray-500">@< link_to post.user.username, user_page_path(post.user.username) %></span> -->
                            <!-- 有卡稱 顯示卡稱，沒卡稱 就不顯示 -->
                            <span>
                                <span class="text-gray-500">・<%= link_to @post.user.cardname, user_page_path(@post.user.username) %></span>
                                <!-- < if post.user.cardname !=nil %>
                                    <span class="text-gray-500">・< link_to post.user.cardname, user_page_path(post.user.username) %></span>
                                < else %>
                                < end %> -->
                            </span>
                            <span class="text-gray-500">・</span><span class="text-sky-500">追蹤</span>
                            <span class="text-gray-500">・<%= @post.created_at.strftime("%Y年%m月%d日 %I:%M") %></span>
                        </div>
                    </article>
                </section>
                <!-- 自己的文章才顯示 編輯、刪除 按鈕-->
                <% if @post.user == current_user %>
                    <section class="column is-2 text-right">
                        <%= link_to edit_post_path(@post) do %>
                            <i class="fa-solid fa-pen mr-2 text-gray-400"></i>
                        <% end %>
                        <%= link_to post_path(@post), data: {turbo_method: :delete, turbo_confirm: "確定刪除此文章？"}  do %>
                            <i class="fa-solid fa-trash-can text-gray-400"></i>
                        <% end %>
                    </section>
                <% else %>
                <% end %>
            </section>

            <div class="w-fit mx-auto mb-2">
                <%= image_tag @post.cover_image.variant(resize_to_limit: [640, nil]) %>
                <!-- 將影像縮小到符合指定尺寸，同時保留原始長寬比。僅當影像大於指定尺寸時才會縮放影像。 -->
            </div>

            <p><%= simple_format(@post.content, class: 'description') %></p>
            <!-- simple_format 讓換行和超連結 正確呈現 -->
            <!-- 使用 class: 'description'方便css選取其 以操縱換行與換行間的間距（換行兩次的段落間 會各自被各自的標籤包住） -->
            <!-- <p class='description'>內文</p> -->
            <!-- https://api.rubyonrails.org/classes/ActionView/Helpers/TextHelper.html#method-i-simple_format -->

            <div class="columns mt-2">
                <div class="column">
                    <i class="fa-brands fa-gratipay text-rose-400 mr-0.5 text-2xl"></i>
                    <span class="text-gray-500">0</span>
                    <span class="text-gray-500 text-lg">・留言</span>
                    <span class="text-gray-500">0</span>
                </div>
                <div class="column text-right">
                    <!-- 要做流程控制變換顏色 -->
                    <i class="fa-brands fa-gratipay text-rose-400 mr-4 text-2xl"></i>
                    <i class="fa-solid fa-bookmark text-sky-500 text-2xl"></i>
                </div>
            </div>
            <div class="text-gray-500">共 0 則留言</div>
            <hr class="h-px my-2 bg-gray-200 border-0 dark:bg-gray-700">
          
            <!-- 留言輸入區 -->
            <%= render 'comment_input', post: @post %>

            <hr class="h-px mb-4 bg-gray-200 border-0 dark:bg-gray-700">

            <!-- 所有留言區 -->
            <section class="columns">
                <section class="column is-7">
                    <article class="media">
                        <figure class="media-left">
                            <!-- 有上傳頭貼 顯示上傳的頭貼，沒頭貼 顯示灰頭 -->
                            <img src="https://fakeimg.pl/50x50/" class="avatar">
                            <!-- < if comment.user.avatar.attached? %>
                                <= image_tag comment.avatar.variant(resize_to_fill: [50, 50]), class: 'avatar' %>
                            < else %>
                                <i class="fa-solid fa-circle-user text-gray-500 text-5xl"></i>
                            < end %> -->
                        </figure>
                        
                        <div class="media-content">
                            <!-- 有卡稱 顯示卡稱+ID，沒卡稱 就只顯示ID -->
                            <!-- < if comment.user.cardname != nil %>
                                <= link_to comment.user.cardname, user_page_path(comment.user.username) %><br>
                                <= link_to "@#{comment.user.username}", user_page_path(comment.user.username), class:'text-gray-400 text-sm' %>
                            < else %>
                                <= link_to user_page_path(comment.user.username) do %>
                                    <div class="text-gray-600 pt-2.5">@<= comment.user.username %></div>
                                < end %>
                            < end %>                                 -->
                        </div>
                    </article>
                </section>
                <!-- 自己的留言才顯示 編輯、刪除 -->
                <section class="column is-5 text-right mt-2">
                    <!-- <= link_to edit_comment_path(comment) do %> -->
                        <i class="fa-solid fa-pen mr-2 text-gray-400"></i>
                    <!-- < end %> -->
                    <!-- <= link_to comment_path(comment), data: {turbo_method: :delete, turbo_confirm: "確定刪除此留言？"}  do %> -->
                        <i class="fa-solid fa-trash-can text-gray-400"></i>
                    <!-- < end %> -->
                </section>
            </section>

            <div class="ml-16">
                <article class="mb-7">
                    留言內容
                </article>
                <p class="text-gray-400 text-sm mb-1.5"><%= Time.current.strftime("%Y年%m月%d日 %I:%M") %></p>
            </div>
            <hr class="h-px my-3 bg-gray-200 border-0 dark:bg-gray-700">
        </section>
    </section>
</div>